<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-updates">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">16 posts tagged with &quot;consensus&quot; | Cardano Development Updates</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://input-output-hk.github.io/cardano-updates/tags/consensus/page/2"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="16 posts tagged with &quot;consensus&quot; | Cardano Development Updates"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/cardano-updates/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://input-output-hk.github.io/cardano-updates/tags/consensus/page/2"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/cardano-updates/tags/consensus/page/2" hreflang="en"><link data-rh="true" rel="alternate" href="https://input-output-hk.github.io/cardano-updates/tags/consensus/page/2" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/cardano-updates/rss.xml" title="Cardano Updates Feed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/cardano-updates/atom.xml" title="Cardano Updates Feed Atom Feed">
<link rel="alternate" type="application/json" href="/cardano-updates/feed.json" title="Cardano Updates Feed JSON Feed">



<link rel="alternate" type="application/rss+xml" href="/cardano-updates/quarterly/rss.xml" title="Cardano Development Updates RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/cardano-updates/quarterly/atom.xml" title="Cardano Development Updates Atom Feed">
<script src="https://plausible.io/js/script.js" defer="defer" data-domain="input-output-hk.github.io/cardano-updates"></script><link rel="stylesheet" href="/cardano-updates/assets/css/styles.1b2b551c.css">
<link rel="preload" href="/cardano-updates/assets/js/runtime~main.5773d37e.js" as="script">
<link rel="preload" href="/cardano-updates/assets/js/main.6db121e8.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cardano-updates/"><div class="navbar__logo"><img src="/cardano-updates/img/logo.svg" alt="Cardano Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/cardano-updates/img/logo.svg" alt="Cardano Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Cardano Updates</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cardano-updates/">Home</a><a class="navbar__item navbar__link" href="/cardano-updates/quarterly">Quarterly</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/cardano-updates/tags">Topics</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/cardano-updates/tags">All Topics</a></li><li><a class="dropdown__link" href="/cardano-updates/tags/network">Network</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/cardano-updates/tags/consensus">Consensus</a></li><li><a class="dropdown__link" href="/cardano-updates/tags/ledger">Ledger</a></li><li><a class="dropdown__link" href="/cardano-updates/tags/hydra">Hydra</a></li><li><a class="dropdown__link" href="/cardano-updates/tags/db-sync">DB Sync</a></li><li><a class="dropdown__link" href="/cardano-updates/tags/cli-api">Node CLI &amp; API</a></li><li><a class="dropdown__link" href="/cardano-updates/quarterly/tags/cli-api-quarterly">Node CLI &amp; API Quarterly</a></li><li><a class="dropdown__link" href="/cardano-updates/tags/crypto">Crypto</a></li></ul></div><a class="navbar__item navbar__link" href="/cardano-updates/archive">Archive</a><a href="https://github.com/input-output-hk/cardano-updates" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent Posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/cardano-updates/2023-04-21-hydra">Hydra Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/cardano-updates/2023-04-21-ledger">Ledger Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/cardano-updates/2023-04-20-mithril">Mithril Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/cardano-updates/2023-04-19-consensus">Consensus Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/cardano-updates/2023-04-19-performance-and-tracing">Performance &amp; tracing update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/cardano-updates/2023-04-17-ledger">Incident Report</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/cardano-updates/2023-04-14-goedel">Goedel Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/cardano-updates/2023-04-14-hydra">Hydra Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/cardano-updates/2023-04-07-hydra">Hydra Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/cardano-updates/2023-04-06-mithril">Mithril Team Update</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>16 posts tagged with &quot;consensus&quot;</h1><a href="/cardano-updates/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/cardano-updates/2023-02-08-consensus">Consensus Team Update</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-02-08T00:00:00.000Z" itemprop="datePublished">February 8, 2023</time> Â· <!-- -->2 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/dnadales.png" alt="Damian Nadales"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Damian Nadales</span></a></div><small class="avatar__subtitle" itemprop="description">Consensus Team Lead</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-summary">High level summary<a class="hash-link" href="#high-level-summary" title="Direct link to heading">â€‹</a></h2><p>We continue refactoring the UTxO HD prototype while we wait for the system level
benchmarks. We have created a new repository that contains the <code>anti-diff</code>
packages used in this prototype.</p><p>On the Genesis front, we are preparing another meeting with the researchers to
audit the implementation design, and we continued working on basic tests and
simplifications.</p><p>During the past two weeks we also introduced two new tools. One for dumping CBOR
encoded blocks to JSON, and another to serve a local immutable DB.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="workstreams">Workstreams<a class="hash-link" href="#workstreams" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="utxo-hd-prototype">UTxO HD Prototype<a class="hash-link" href="#utxo-hd-prototype" title="Direct link to heading">â€‹</a></h3><p>We are in the process of refactoring the UTxO HD prototype, while we wait for
the system level benchmarks to confirm if the performance of the prototype is
satisfactory.</p><p>We also set up a repository for the <a href="https://github.com/input-output-hk/anti-diffs" target="_blank" rel="noopener noreferrer"><code>anti-diff</code></a> package, which
required us to refactor the code, write documentation, and prepare a release to
<a href="https://github.com/input-output-hk/cardano-haskell-packages" target="_blank" rel="noopener noreferrer">CHaP</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="genesis">Genesis<a class="hash-link" href="#genesis" title="Direct link to heading">â€‹</a></h3><p>We worked on <a href="https://github.com/input-output-hk/ouroboros-network/issues/4347" target="_blank" rel="noopener noreferrer">basic tests</a> for the <em>Limit on Eagerness</em> property of
Genesis. We also introduced further robustness and simplifications in the
Genesis Density governor. Finally, we developed a presentation to engage again
with the researchers on our Genesis implementation design.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="technical-debt">Technical debt<a class="hash-link" href="#technical-debt" title="Direct link to heading">â€‹</a></h3><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fostering-collaboration">Fostering collaboration<a class="hash-link" href="#fostering-collaboration" title="Direct link to heading">â€‹</a></h3><p>We are in the process of <a href="https://github.com/input-output-hk/ouroboros-consensus/pull/6" target="_blank" rel="noopener noreferrer">polishing</a> the <code>ouroboros-consensus</code>
documentation site, which we will use a the entry point for Consensus related
documentation. The first version will not be complete, but we plan on
systematically improving it.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="support">Support<a class="hash-link" href="#support" title="Direct link to heading">â€‹</a></h3><p>We <a href="https://github.com/input-output-hk/ouroboros-network/pull/4335" target="_blank" rel="noopener noreferrer">added a tool</a> to <code>ouroboros-consensus-cardano-tools</code> which allows
to dump the Chain DB blocks or any given CBOR encoded blocks as JSON.</p><p>We also added <a href="https://github.com/input-output-hk/ouroboros-network/pull/4339" target="_blank" rel="noopener noreferrer">another tool</a> that serves an existing immutable DB via
BlockFetch and ChainSync. This tool can help in assisting our local benchmarking
efforts (for instance Genesis&#x27; ChainSync jumping prototype).</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/cardano-updates/tags/consensus">consensus</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/cardano-updates/2023-01-25-consensus">Consensus Team Update</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-01-25T00:00:00.000Z" itemprop="datePublished">January 25, 2023</time> Â· <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/dnadales.png" alt="Damian Nadales"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Damian Nadales</span></a></div><small class="avatar__subtitle" itemprop="description">Consensus Team Lead</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-summary">High level summary<a class="hash-link" href="#high-level-summary" title="Direct link to heading">â€‹</a></h2><p>During the past two weeks, the consensus team finished the testing activities
around the UTxO-HD prototype. This is a very important milestone which will
enable us to run system-level tests and benchmarks, as well as start refactoring
and cleaning the prototype. Regarding our Genesis workstream, we elaborated a
roadmap that gives an indication of the remaining work. We also continued our
work on benchmarking chain-sync-jumping. We also continued working on improving
the way we handle blocks from the future, and advancing the integration of the
new VRF and KES crypto.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="workstreams">Workstreams<a class="hash-link" href="#workstreams" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="utxo-hd-prototype">UTxO HD Prototype<a class="hash-link" href="#utxo-hd-prototype" title="Direct link to heading">â€‹</a></h3><p>As the prototype is nearing its completion, it was important to have enough
confidence that we will be able to move additional parts of the ledger state
onto disk. We worked together with the Ledger team to <a href="https://github.com/input-output-hk/ouroboros-network/pull/4296" target="_blank" rel="noopener noreferrer">elaborate a
sketch</a> on how the UTxO-HD design would accommodate the migration of
additional data from memory to disk. This gave us enough confidence that the
current architecture will be extensible in the future.</p><p>On the testing front, we <a href="https://github.com/input-output-hk/ouroboros-network/pull/4274" target="_blank" rel="noopener noreferrer">added</a> property-based tests for the UTxO-HD
type classes. </p><p>We also <a href="https://github.com/input-output-hk/ouroboros-network/issues/4289" target="_blank" rel="noopener noreferrer">enabled disabled components</a>, and addressed several
technical debt issues:</p><ul><li>Implement <code>splitSized</code> anti-diff split (<a href="https://github.com/input-output-hk/ouroboros-network/pull/4269" target="_blank" rel="noopener noreferrer">#4269</a>), and integrate it
into consensus (<a href="https://github.com/input-output-hk/ouroboros-network/pull/4273" target="_blank" rel="noopener noreferrer">#4273</a>).</li><li>Renaming of <code>peekVal</code> to <code>peekMDBVal</code> (<a href="https://github.com/input-output-hk/lmdb-simple/pull/7" target="_blank" rel="noopener noreferrer">#7</a>).</li></ul><p>We ran ad-hoc benchmarks for syncing a chain from scratch and replaying. We
found a race condition in the LMDB backing store, which <a href="https://github.com/input-output-hk/ouroboros-network/pull/4283" target="_blank" rel="noopener noreferrer">we fixed</a>.
After the fix we were able to successfully run these benchmarks. The results
were published by <a href="https://github.com/input-output-hk/ouroboros-network/pull/4295" target="_blank" rel="noopener noreferrer">this pull request</a>.</p><p>We used our <code>db-analyser</code> tool to benchmark the cost of reading keys and
flushing values to disk. The following plot shows the duration of these disk
operation in relation to the main ledger operations, where we can see that the
cost of the former are comparatively low. The spike at the beginning of the
graph is when, at the start of the Shelley era, the <em>entire</em> UTxO set is flushed
to disk.</p><p><img loading="lazy" alt="UTxO-HD read and flush benchmarks" src="/cardano-updates/assets/images/2023-01-25-consensus-utxo-hd-read-and-flush-benchmarks-6b129a1acaa4bb48443ee81add51fd39.png" width="1600" height="800" class="img_ev3q"></p><p>After months of hard work adding tests for the prototype, we are ready to run
end-to-end tests on the node, and system level benchmarks. This signals a very
important milestone for the UTxO-HD workstream ðŸŽ‰.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="genesis">Genesis<a class="hash-link" href="#genesis" title="Direct link to heading">â€‹</a></h3><p>We elaborated a <a href="https://github.com/input-output-hk/ouroboros-network/blob/a626c84f6df585dd27d735eb7eec73904a1f570e/ouroboros-consensus/docs/2023-Jan-Genesis-roadmap.md" target="_blank" rel="noopener noreferrer">high-level decomposition</a> of the remaining
work for Genesis. We also continued benchmarking the chain-sync-jumping
happy-path.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="technical-debt">Technical debt<a class="hash-link" href="#technical-debt" title="Direct link to heading">â€‹</a></h3><p>We continued working on improving the way we handle blocks from the future.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="support">Support<a class="hash-link" href="#support" title="Direct link to heading">â€‹</a></h3><p>We completed the mapping of <code>Crypto</code> to <code>HeaderCrypto</code> and body <code>Crypto</code>.
<code>HeaderCrypto</code> is moved to <code>cardano-protocol-tpraos</code>. We created a draft <a href="https://github.com/input-output-hk/cardano-ledger/pull/3262" target="_blank" rel="noopener noreferrer">pull
request</a> to facilitate compiling consensus.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/cardano-updates/tags/consensus">consensus</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/cardano-updates/2023-01-11-consensus">Consensus Team Update</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-01-11T00:00:00.000Z" itemprop="datePublished">January 11, 2023</time> Â· <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/dnadales.png" alt="Damian Nadales"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Damian Nadales</span></a></div><small class="avatar__subtitle" itemprop="description">Consensus Team Lead</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-summary">High level summary<a class="hash-link" href="#high-level-summary" title="Direct link to heading">â€‹</a></h2><p>The consensus team is resuming its activities after the Christmas break. During
these weeks we focused on cleaning and benchmarking the UTxO-HD prototype, and
discussing with the Ledger team the changes that might be required for the next
iterations. The pull request that adds the Conway era is waiting for a second
review round and we hope to merge it soon. On the technical debt side we are
looking into a property-test failure found in the iterators. We are
investigating if this is an error in the model or in the implementation. We also
improved the documentation of our testing code.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="workstreams">Workstreams<a class="hash-link" href="#workstreams" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="utxo-hd-prototype">UTxO HD Prototype<a class="hash-link" href="#utxo-hd-prototype" title="Direct link to heading">â€‹</a></h3><p>We worked with the Ledger team to start preparing the next versions of UTxO-HD.
The Ledger team is concerned that for the remaining maps we might need the full
ledger state on epoch boundaries. Since the main consumer of the ledger rules is
Consensus, the code that requires access to a full state could be moved from the
ledger to some Ledger-Consensus bridge. Eg. the traversal of rewards could take
place in such bridge, instead of querying the ledger for the values that are
required in the epoch-transition computations.</p><p>We <a href="https://github.com/input-output-hk/ouroboros-network/pull/4234" target="_blank" rel="noopener noreferrer">relocated</a> some UTxO-HD definitions, in preparation for merging
the prototype into <code>master</code>.</p><p>We also completed updated local benchmarks comparing the replay time and memory
consumption of:</p><ul><li>the baseline node (<code>f2fc76ef45647275c98634da1718290b976ff364</code>) </li><li>the UTxO-HD node with the in-memory backend </li><li>the UTxO-HD node with the LMDB backend</li></ul><p>The following plot shows the results: we can see that the LMDB node barely
reaches 8GB of memory, but it takes 1.78 times longer to replay the chain. The
in-memory backend is about 30 minutes faster, but still slower than the baseline
version. We are aware of this phenomenon and it is inherent to the problem of
maintaining sequences of differences of the last <code>k</code> ledger states that allows
us to perform rollback and roll-forward. We are in the process of measuring
syncing from scratch times.</p><p><img loading="lazy" src="/cardano-updates/assets/images/2023-01-11-utxo-hd-replay-benchmarks-dcf6daaf5460de7591a60db1457d2e58.png" width="2500" height="1700" class="img_ev3q"></p><p>We also <a href="https://github.com/input-output-hk/ouroboros-network/pull/4263" target="_blank" rel="noopener noreferrer">added <code>StaticEither</code> accessors</a> that helped us to simplify
the UTxO-HD prototype.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-conway-era">New Conway era<a class="hash-link" href="#new-conway-era" title="Direct link to heading">â€‹</a></h3><p>We incorporated the feedback of the <a href="https://github.com/input-output-hk/ouroboros-network/pull/3971" target="_blank" rel="noopener noreferrer">pull request</a>, and rebased this
branch on top of <code>master</code>. The PR is pending a second review round and we hope
to merge this soon.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="technical-debt">Technical debt<a class="hash-link" href="#technical-debt" title="Direct link to heading">â€‹</a></h3><p>We are investigating a <a href="https://github.com/input-output-hk/ouroboros-network/issues/4183" target="_blank" rel="noopener noreferrer">property-testing failure</a> involving
iterators. Solving this requires understanding the expected behavior of
iterators in the counterexample found by <code>QuickCheck</code> to determine if the error
is in the model or in the implementation.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fostering-collaboration">Fostering collaboration<a class="hash-link" href="#fostering-collaboration" title="Direct link to heading">â€‹</a></h3><p>We <a href="https://github.com/input-output-hk/ouroboros-network/pull/4248" target="_blank" rel="noopener noreferrer">moved</a> the contents of <code>docs/Testing.md</code> closer to the code, so that the
explanations about the tests are easier to find in the relevant modules, and the
documentation is easier to keep up to date.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/cardano-updates/tags/consensus">consensus</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/cardano-updates/2022-12-14-consensus">Consensus Team Update</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-12-14T00:00:00.000Z" itemprop="datePublished">December 14, 2022</time> Â· <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/dnadales.png" alt="Damian Nadales"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Damian Nadales</span></a></div><small class="avatar__subtitle" itemprop="description">Consensus Team Lead</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-summary">High level summary<a class="hash-link" href="#high-level-summary" title="Direct link to heading">â€‹</a></h2><p>During the past two weeks, the Consensus team finalized the QSM tests for the
backing store and Mempool on the UTxO-HD branch with important discoveries
regarding parallel QSM testing. We also worked with the Ledger team to envisage
the modifications that are required in Ledger and Consensus to accommodate the
changes in the crypto VRF and KES. The <code>db-analyser</code> now supports bechmarking
the ledger operations, which will allow us to identify, debug, and profile
potential performance problems. We drafted a document that defines how to manage
the versions of Consensus-related packages. The top level documentation of
<code>ouroboros-network</code> now features a description of the consensus components and
provides a hyperlinked map to the modules documentation.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="workstreams">Workstreams<a class="hash-link" href="#workstreams" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="utxo-hd-prototype">UTxO HD prototype<a class="hash-link" href="#utxo-hd-prototype" title="Direct link to heading">â€‹</a></h3><p>Whereas we had passing sequential state-machine tests for the mempool, the
parallel case proved to be more challenging than we thought. The operation of
adding a list of transactions to the mempool is not atomic and, as a result,
when adding a list of transactions, transactions from other processes can be
added in between. The mempool implementation handles this correctly, however
this required us to <a href="https://github.com/input-output-hk/ouroboros-network/pull/4076" target="_blank" rel="noopener noreferrer">redesign</a> the parallel model we had to take
the lack of atomicity into account.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="backing-store-property-tests">Backing store property tests<a class="hash-link" href="#backing-store-property-tests" title="Direct link to heading">â€‹</a></h4><p>We finished refactoring the backing store property tests. The second review
round is ongoing.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lsm-tree-implementation">LSM tree implementation<a class="hash-link" href="#lsm-tree-implementation" title="Direct link to heading">â€‹</a></h3><p>We are working on benchmarking (in terms of time and number of IO operations)
fetching/looking up data from disk.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="genesis">Genesis<a class="hash-link" href="#genesis" title="Direct link to heading">â€‹</a></h3><p>We worked on the design of a mechanism to prevent a DoS attack on our Genesis
design related to rollbacks. This was arguably the biggest outstanding question.</p><p>During the discussions around Genesis, we noticed a design boundary that nicely
delineates a fundamental component. We almost have a full Haskell prototype of
it. It will be very nicely self-contained, perhaps even usable in the ultimate
implementation!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-vrf-and-kes-crypto-integration">New VRF and KES crypto integration<a class="hash-link" href="#new-vrf-and-kes-crypto-integration" title="Direct link to heading">â€‹</a></h3><p>We collaborated with the Ledger team on preparing the ledger state and crypto
types to avoid huge allocation on the epoch boundary when changing aspects of
the crypto that will only manifest in headers, not in the ledger states.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="technical-debt">Technical debt<a class="hash-link" href="#technical-debt" title="Direct link to heading">â€‹</a></h3><p>We merged the <a href="https://github.com/input-output-hk/ouroboros-network/pull/4014" target="_blank" rel="noopener noreferrer">pull-request</a> that adds a support to <code>db-analyser</code> for
benchmarking ledger operations. This will allow us to identify, debug, and
profile potential performance problems. The benchmark focus on the main 5 ledger
operations that are involved in chain syncing, block forging, and block
validation, namely:</p><ol start="0"><li>Forecast.</li><li>Header tick.</li><li>Header application.</li><li>Block tick.</li><li>Block application.</li></ol><p>The following figure shows a plot of the benchmarking results for the first 65
million blocks (approximately) of the Cardano chain. The thin yellow lines under
the x-axis show the epoch boundaries, whereas the thick yellow lines correspond
to the era transitions.</p><p><img loading="lazy" src="/cardano-updates/assets/images/2022-12-14-ledger-ops-benchmark-c46be3db45ff5480ed104e0d520711a6.png" width="1600" height="800" class="img_ev3q"></p><p>As we can see in this figure, era and epoch boundaries require more computation
time. The ledger team are aware of this problem, and we are working to improve
this situation.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fostering-collaboration">Fostering collaboration<a class="hash-link" href="#fostering-collaboration" title="Direct link to heading">â€‹</a></h3><p>We <a href="https://github.com/input-output-hk/ouroboros-network/pull/4207" target="_blank" rel="noopener noreferrer">drafted a document</a> motivating and defining how Consensus (and
possibly other core teams) will/should manage our package versions. This
pull-request garnered many great discussions from our team members and other
teams too: Sebastian Nagel, Arnaud Bailly, Michael Peyton-Jones, Ziyang Liu, et
al. We want to thank you all for your input, and we found this discussion very
enlightening!</p><p>We merged the <a href="https://github.com/input-output-hk/ouroboros-network/pull/4197" target="_blank" rel="noopener noreferrer">pull request</a> that adds an overview of consensus to
the <a href="https://input-output-hk.github.io/ouroboros-network/" target="_blank" rel="noopener noreferrer">top level
documentation</a> of
ouroboros-network. This overview describes the consensus components and adds a
hyperlinked map to the modules documentation.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/cardano-updates/tags/consensus">consensus</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/cardano-updates/2022-11-30-consensus">Consensus Team Update</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-11-30T00:00:00.000Z" itemprop="datePublished">November 30, 2022</time> Â· <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/dnadales.png" alt="Damian Nadales"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Damian Nadales</span></a></div><small class="avatar__subtitle" itemprop="description">Consensus Team Lead</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-summary">High level summary<a class="hash-link" href="#high-level-summary" title="Direct link to heading">â€‹</a></h2><p>During the past two weeks, the consensus team merged improvements to the monadic
cursor API that was needed to implement LMDB range reads, which is in turn
required for the implementation of the UTxO HD feature. We added tables to
several tests in for the UTxO HD feature, which increases our confidence in the
correctness of the prototype. The mempool property tests are close to being
completed. Also, we finished the LSM tree tuning algorithm.</p><p>On the Genesis front we started simplifying the BlockFetch logic with
CSJ-specific workloads in mind. </p><p>We are also documenting the Block Diffusion Pipelining feature, and added a
high-level overview of consensus to the top level documentation of
<code>ouroboros-network</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="workstreams">Workstreams<a class="hash-link" href="#workstreams" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="utxo-hd-prototype">UTxO HD prototype<a class="hash-link" href="#utxo-hd-prototype" title="Direct link to heading">â€‹</a></h3><p>We merged the implementation of a monadic cursor API (<a href="https://github.com/input-output-hk/lmdb-simple/pull/1" target="_blank" rel="noopener noreferrer">#1</a>)) which was
needed to solve a bug with LMDB range-reads. After this PR was merged, we focused on
bridging the gap between the <code>lmdb-simple</code> interface and consensus by facilitating
using <code>lmdb-simple</code>&#x27;s cursor API without <code>Serialise</code> constraints (<a href="https://github.com/input-output-hk/lmdb-simple/pull/3" target="_blank" rel="noopener noreferrer">#3</a>).</p><p>We refactored the backing store property tests to use <code>quickcheck-lockstep</code>
(<a href="https://github.com/input-output-hk/ouroboros-network/pull/4081" target="_blank" rel="noopener noreferrer">#4081</a>).</p><p>We added tables to the mock ledger in the UTxO-HD feature branch
(<a href="https://github.com/input-output-hk/ouroboros-network/pull/4184" target="_blank" rel="noopener noreferrer">#4184</a>). Every test that used to run with <code>SimpleBlocks</code> now uses
tables. This will enable us to exercise the UTxO HD mempool integration by
leveraging the existing mempool property-tests. The new state-machine
property-tests are still needed for testing the parallel behaviour of the
mempool.</p><p>Our work on the mempool state-machine tests revealed the need for improvements
in the <code>quickcheck-state-machine</code> library. Parallel testing assumed that the
state machine did not have access to mutable references. However, the mempool
tests require the use of such mutable references for mocking the ledger
interface. As a result, our parallel tests were failing with rather obscure
messages. @Jasagredo submitted a pull request (<a href="https://github.com/stevana/quickcheck-state-machine/pull/12" target="_blank" rel="noopener noreferrer">#12</a>) that allows for
new mutable references to be created at each run of the state machine.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="backing-store-property-tests">Backing store property tests<a class="hash-link" href="#backing-store-property-tests" title="Direct link to heading">â€‹</a></h4><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lsm-tree-implementation">LSM tree implementation<a class="hash-link" href="#lsm-tree-implementation" title="Direct link to heading">â€‹</a></h3><p>We finished the LSM Tree tuning algorithm. We are currently tidying up the code
and gathering results (i.e., plots and their interpretation).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="csj-prototype">CSJ prototype<a class="hash-link" href="#csj-prototype" title="Direct link to heading">â€‹</a></h3><p>We started simplifying the BlockFetch logic with CSJ-specific workloads in mind.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-vrf-and-kes-crypto-integration">New VRF and KES crypto integration<a class="hash-link" href="#new-vrf-and-kes-crypto-integration" title="Direct link to heading">â€‹</a></h3><p>Started working on supporting new version of <code>StandardCrypto</code> which uses compact
KES and batched VRF (<a href="https://github.com/input-output-hk/ouroboros-network/issues/4151" target="_blank" rel="noopener noreferrer">#4151</a>).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="technical-debt">Technical debt<a class="hash-link" href="#technical-debt" title="Direct link to heading">â€‹</a></h3><p>We reviewed the existing state of the Block Diffusion Pipelining document. We
are now working on the &quot;Implementation&quot; section (<a href="https://github.com/input-output-hk/ouroboros-network/issues/4020" target="_blank" rel="noopener noreferrer">#4020</a>).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="fostering-collaboration">Fostering collaboration<a class="hash-link" href="#fostering-collaboration" title="Direct link to heading">â€‹</a></h3><p>We cleared up our understanding of the error dynamics of forecasting
(<a href="https://github.com/input-output-hk/ouroboros-network/pull/4146" target="_blank" rel="noopener noreferrer">#4146</a> and <a href="https://github.com/input-output-hk/ouroboros-network/pull/4174" target="_blank" rel="noopener noreferrer">#4174</a>).</p><p>We submitted a pull request that adds an overview of consensus to the <a href="https://input-output-hk.github.io/ouroboros-network/" target="_blank" rel="noopener noreferrer">top level
documentation</a> of
ouroboros-network (<a href="https://github.com/input-output-hk/ouroboros-network/pull/4197" target="_blank" rel="noopener noreferrer">#4197</a>). This overview describes the consensus components and adds a
hyperlinked map to the modules documentation.</p><p><a href="https://github.com/input-output-hk/ouroboros-network/pull/4197" target="_blank" rel="noopener noreferrer">https://github.com/input-output-hk/ouroboros-network/pull/4197</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/cardano-updates/tags/consensus">consensus</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/cardano-updates/tags/consensus"><div class="pagination-nav__label">Newer Entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cardano-updates/tags/consensus/page/3"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/cardano-updates/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/cardano-updates/archive">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/cardano-updates/tags">Tags</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Input Output Global, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/cardano-updates/assets/js/runtime~main.5773d37e.js"></script>
<script src="/cardano-updates/assets/js/main.6db121e8.js"></script>
</body>
</html>